(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab8da"],{1687:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("avue-crud",t._g(t._b({attrs:{search:t.search,page:t.page},on:{"update:search":function(e){t.search=e},"update:page":function(e){t.page=e}},scopedSlots:t._u([{key:"controlListForm",fn:function(e){return[o("ControlTree",{key:e,staticClass:"ControlTree",attrs:{defaultExpandedKeys:t.form.controlList,data:t.controlList},on:{checked:t.checked}})]}}]),model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},"avue-crud",t.bindVal,!1),t.onEvent))],1)},r=[],c=o("e7e7"),i=o("efe28"),a=(o("b4fb"),o("08ba"),o("2eeb"),o("dbb3"),o("d718")),l=o("5880"),s=o("337a"),d=o("82ff"),f=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-tree",{ref:"tree",attrs:{accordion:"",data:t.data,"show-checkbox":"","node-key":"controlId","default-checked-keys":t.defaultExpandedKeys,props:t.defaultProps},on:{check:t.check}})],1)},u=[],h={props:{data:{},defaultExpandedKeys:{type:Array,default:[]}},data:function(){return{defaultProps:{children:"controlList",label:"controlName"}}},created:function(){},methods:{check:function(){var t=this.$refs.tree.getCheckedKeys().concat(this.$refs.tree.getHalfCheckedKeys());this.$emit("checked",t)}}},p=h,m=o("5d22"),L=Object(m["a"])(p,f,u,!1,null,null,null),b=L.exports,k={components:{ControlTree:b},computed:Object(i["a"])({},Object(l["mapGetters"])(["name"])),mixins:[a["a"],d["a"]],data:function(){return{controlList:[],controlListChecked:[],isIndeterminate:!1,defaultProps:{children:"controlList",label:"controlName"},search:{conditionTwo:""},config:{detail:"/role/findByRId",save:"/role/addRole",delete:"/role/deRoleByUId",update:"/role/updateRole",list:"/role/findAll"},method:{detail:"GET",delete:"GET",list:"GET"},rowKey:"id",option:{addBtn:!0,viewBtn:!1,column:[].concat(Object(c["a"])(this.column_def("角色名","roleName",!0,{search:!0,searchSpan:6,fixed:"left",minWidth:180})),Object(c["a"])(this.column_textarea("备注","remark",!1,{minWidth:180})),[{label:"用户权限",prop:"controlList",minWidth:180,span:24,hide:!0,formslot:!0},{label:"创建人",prop:"addUser",display:!1,formatter:function(t,e,o,n){return t.addUser?t.addUser.username:""}},{label:"创建时间",prop:"addTime",display:!1,minWidth:180},{label:"最后更改人",prop:"updateUser",display:!1,formatter:function(t,e,o,n){return t.updateUser?t.updateUser.username:""}},{label:"最后更改时间",prop:"updateTime",display:!1,minWidth:180}])}}},watch:{form:{handler:function(t,e){t.controlList=this.controlListChecked},deep:!0}},methods:{updateBefore:function(){return this.form.controlList=this.controlListChecked,1},addBefore:function(){return this.form.controlList=this.controlListChecked,1},checked:function(t){console.log("checked",t),this.controlListChecked=t},delBefore:function(t){var e=t;return e={roleId:t.roleId},e},recursive:function(t){var e=this,o=function(){var o=function e(o){return o.forEach((function(o){o.controlList&&o.controlList.length>0&&(o.controlList=e(o.controlList||[])),o.disabled=t})),o};e.controlList=Object.assign(o(e.controlList),{})};o()},openBefore:function(t){var e=this;"edit"==t&&(e.form.id=e.form.roleId,console.log("openBefore",e.form),e.form.status&&1==e.form.status?e.recursive(!0):e.recursive(!1)),"add"==t&&(e.form.controlList=[],e.controlListChecked=[]),e.form=Object.assign(e.form,e.form)},openAfter:function(t,e,o,n){var r=this;e.controlList=t.data.map((function(t){return t.controlId}));var c={},i=function(){var t=function t(e){return e.forEach((function(e){e.controlList&&e.controlList.length>0?e.controlList=t(e.controlList||[]):c[e.controlId]=!0})),e};t(r.controlList)};i(),e.controlList=e.controlList.filter((function(t){return c[t]})),r.controlListChecked=e.controlList,r.form=Object.assign(e,{})},listAfter:function(t){this.data.forEach((function(t){t.controlList=[]}))},findControl:function(){var t=this;Object(s["a"])("/role/findControl",{},"GET").then((function(e){t.controlList=e.data})).catch((function(t){console.log(t)}))}},created:function(){this.findControl()}},v=k,y=Object(m["a"])(v,n,r,!1,null,null,null);e["default"]=y.exports}}]);