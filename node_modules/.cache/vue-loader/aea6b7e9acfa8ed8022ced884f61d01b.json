{"remainingRequest":"/Users/careershe03/Desktop/front-korea/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/careershe03/Desktop/front-korea/admin/src/views/students/operation/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/careershe03/Desktop/front-korea/admin/src/views/students/operation/index.vue","mtime":1624871492673},{"path":"/Users/careershe03/Desktop/front-korea/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/careershe03/Desktop/front-korea/admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/careershe03/Desktop/front-korea/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/careershe03/Desktop/front-korea/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgdmFsaWRhdGVQaG9uZSwKICB2YWxpZGF0ZVVzZXJuYW1lCn0gZnJvbSAiLi4vLi4vLi4vdXRpbHMvdmFsaWRhdGUiOwppbXBvcnQge2dldFN0dWRlbnRJbmZvLCByZW1vdmVTdHVkZW50VG9DbGFzcywgdXBkYXRlU3R1ZGVudEluZm99IGZyb20gIi4uLy4uLy4uL2FwaS9zdHVkZW50cyI7CmltcG9ydCB7c2VsZWN0Q2xhc3NMaXN0LCBzZWxlY3RUeXBlTGlzdH0gZnJvbSAiLi4vLi4vLi4vYXBpL3NlYXJjaCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZGV4IiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGFyYW1zOiB7CiAgICAgICAgc3R1ZGVudElkOiAnJywKICAgICAgICBncmFkZUlkOiAnJwogICAgICB9LAogICAgICBmb3JtOiB7fSwKICAgICAgcnVsZXM6IHsKICAgICAgICB1c2VybmFtZTogW3tyZXF1aXJlZDogdHJ1ZSwgdHJpZ2dlcjogJ2JsdXInLCB2YWxpZGF0b3I6IHZhbGlkYXRlUGhvbmV9XSwKICAgICAgICBuYW1lOiBbe3JlcXVpcmVkOiB0cnVlLCB0cmlnZ2VyOiAnYmx1cicsIHZhbGlkYXRvcjogdmFsaWRhdGVVc2VybmFtZX1dLAogICAgICB9LAogICAgICB0ZWFjaGVyTGlzdDogW10sCiAgICAgIGNsYXNzTGlzdDogW10sCiAgICAgIGZpcnN0TGlzdDogW10sCiAgICAgIHJlY2xlYW5pbmcxTGlzdDogW10sCiAgICAgIHJlY2xlYW5pbmcyTGlzdDogW10KICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBsZXQge3N0dWRlbnRJZCwgZ3JhZGVJZH0gPSB0aGlzLiRyb3V0ZS5xdWVyeTsKICAgIHRoaXMucGFyYW1zLnN0dWRlbnRJZCA9IHN0dWRlbnRJZDsKICAgIHRoaXMucGFyYW1zLmdyYWRlSWQgPSBncmFkZUlkOwogICAgdGhpcy5nZXRFZGl0RGF0YSh0aGlzLnBhcmFtcyk7CiAgICB0aGlzLmdldENsYXNzRGF0YSgpOwogICAgdGhpcy5nZXRGaXJzdFNlbGVjdERhdGEoKTsKICAgIHRoaXMuZ2V0UmVjbGVhbmluZ0RhdGEoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldEZpcnN0U2VsZWN0RGF0YSgpIHsKICAgICAgc2VsZWN0VHlwZUxpc3QoJ2ZpcnN0Q2hvaWNlJykKICAgICAgICAgIC50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIGlmIChyZXMuZXJyb3JDb2RlID09PSAyMDApIHRoaXMuZmlyc3RMaXN0ID0gcmVzLmRhdGE7CiAgICAgICAgICB9KQogICAgfSwKICAgIGdldFJlY2xlYW5pbmdEYXRhKCkgewogICAgICBzZWxlY3RUeXBlTGlzdCgncmVjbGVhbmluZycpCiAgICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMsICdzYWQnKTsKICAgICAgICAgICAgaWYgKHJlcy5lcnJvckNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIHRoaXMucmVjbGVhbmluZzFMaXN0ID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgdGhpcy5yZWNsZWFuaW5nMkxpc3QgPSByZXMuZGF0YTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgIH0sCiAgICBnZXRDbGFzc0RhdGEoKSB7CiAgICAgIHNlbGVjdENsYXNzTGlzdCgpCiAgICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgICBpZiAocmVzLmVycm9yQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QgPSByZXMuZGF0YTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgIH0sCiAgICBnZXRFZGl0RGF0YShwYXJhbXMpIHsKICAgICAgZ2V0U3R1ZGVudEluZm8ocGFyYW1zKQogICAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5lcnJvckNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIHRoaXMuZm9ybSA9IHJlcy5kYXRhOwogICAgICAgICAgICAgIHRoaXMuZm9ybVsnZ2VuZGVyJ10gPSB0aGlzLmZvcm0uZ2VuZGVyID09ICdmJyA/ICfnlLcnIDogJ+Wlsyc7CgogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgfSwKICAgIGdvQmFjaygpIHsKICAgICAgdGhpcy4kcm91dGVyLmdvKC0xKTsKICAgIH0sCiAgICByZW1vdmVDbGFzc0luZm8oc3R1ZGVudElkKSB7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgdGhhdC4kY29uZmlybSgn5q2k5pON5L2c5bCG5Lya5bCG6K+l5ZCN5a2m55Sf56e75Ye65b2T5YmN54+t57qnLCDmmK/lkKbnu6fnu60/JywgJ+enu+mZpOWtpueUnycsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHJlbW92ZVN0dWRlbnRUb0NsYXNzKHN0dWRlbnRJZCkKICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICBpZiAocmVzLmVycm9yQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGF0LiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn56e76Zmk5oiQ5YqfIScKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhhdC5nZXRFZGl0RGF0YSh0aGF0LnBhcmFtcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZyhzdHVkZW50SWQpOwogICAgfSwKICAgIG9wZXJhdGlvbkRhdGEoKSB7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgdGhhdC5mb3JtWydnZW5kZXInXSA9IHRoaXMuZm9ybS5nZW5kZXIgPT09ICfnlLcnID8gJ2YnIDogJ20nOwogICAgICB0aGF0LiRyZWZzWydmb3JtJ10udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdXBkYXRlU3R1ZGVudEluZm8odGhhdC5mb3JtKQogICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/students/operation","sourcesContent":["<template>\n  <div>\n    <el-form label-width=\"80px\" :model=\"form\" :rules=\"rules\" ref=\"form\">\n      <basic-container>\n        <span class=\"tip-info\"></span>\n        <span class=\"tip-title\">基本信息</span>\n        <div style=\"margin-top: 20px\">\n          <el-row :gutter=\"4\">\n            <el-col :span=\"10\">\n              <el-form-item label=\"学生ID\">\n                <el-input v-model=\"form._id\" disabled/>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"10\">\n              <el-form-item label=\"头像\">\n                <el-avatar size=\"30\" :src=\"form.profilePicture\"></el-avatar>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row :gutter=\"4\">\n            <el-col :span=\"10\">\n              <el-form-item label=\"姓名\" required prop=\"name\">\n                <el-input v-model=\"form.name\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"10\">\n              <el-form-item label=\"性别\">\n                <el-input v-model=\"form.gender\" disabled></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-row :gutter=\"4\">\n            <el-col :span=\"10\">\n              <el-form-item label=\"手机号\" required prop=\"username\">\n                <el-input v-model=\"form.username\"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"10\">\n              <el-form-item label=\"激活日期\">\n                <el-input v-model=\"form.activationDate\" disabled></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n        </div>\n      </basic-container>\n      <basic-container>\n        <span class=\"tip-info\"></span>\n        <span class=\"tip-title\">班级信息</span>\n        <template v-if=\"form.gradeDto\">\n          <div class=\"table-wrap\">\n            <div class=\"table-title\" style=\"background-color: #FFFFFF\">\n              <span>班级ID</span>\n              <span>班级名称</span>\n              <span>班级类型</span>\n              <span>年级</span>\n              <span>入学年份</span>\n              <span>班主任</span>\n              <span>生涯导师1</span>\n              <span>生涯导师2</span>\n              <span>操作</span>\n            </div>\n            <div class=\"student-table-title\">\n              <span>{{ form.gradeDto._id.slice(0, 12) }}</span>\n              <span>{{ form.gradeDto.name }}</span>\n              <span>{{ form.gradeDto.gradeType }}</span>\n              <span>{{ form.gradeDto.grade }}</span>\n              <span>{{ form.gradeDto.enrollmentYear }}</span>\n              <span>{{ form.gradeDto.teacherName }}</span>\n              <span>{{ form.gradeDto.teacher1Name }}</span>\n              <span>{{ form.gradeDto.teacher2Name }}</span>\n              <span style=\"color: #FF0000; cursor:pointer;\" @click=\"removeClassInfo(form._id)\">解除班级绑定</span>\n            </div>\n          </div>\n        </template>\n        <template v-else>\n          <div style=\"margin-top: 20px\">\n            <span class=\"tip-title\" style=\"margin-right: 20px\">选择班级</span>\n            <el-select v-model=\"form.gradeId\" placeholder=\"请选择\" clearable>\n              <el-option v-for=\"item in classList\" :key=\"item._id\" :label=\"item.name\" :value=\"item._id\"/>\n            </el-select>\n          </div>\n        </template>\n      </basic-container>\n      <basic-container style=\"margin-bottom: 60px\">\n        <span class=\"tip-info\"></span>\n        <span class=\"tip-title\">选科信息</span>\n        <div style=\"margin-top: 20px\">\n          <span class=\"tip-title\">首选科目</span>\n          <el-select v-model=\"form.firstChoice\" placeholder=\"请选择\" clearable class=\"m-right\">\n            <el-option v-for=\"(item, index) in firstList\" :key=\"index\" :label=\"item.name\" :value=\"item.name\"/>\n          </el-select>\n          <span class=\"tip-title\">再选科目1</span>\n          <el-select v-model=\"form.recleaning1\" placeholder=\"请选择\" clearable class=\"m-right\">\n            <el-option v-for=\"(item, index) in recleaning1List\" :key=\"index\" :label=\"item.name\" :value=\"item.name\"/>\n          </el-select>\n          <span class=\"tip-title\">再选科目2</span>\n          <el-select v-model=\"form.recleaning2\" placeholder=\"请选择\" clearable class=\"m-right\">\n            <el-option v-for=\"(item, index) in recleaning2List\" :key=\"index\" :label=\"item.name\" :value=\"item.name\"/>\n          </el-select>\n        </div>\n      </basic-container>\n    </el-form>\n    <div class=\"footer-btn\">\n      <el-button style=\"color: #475B75\" @click=\"goBack\">取消</el-button>\n      <el-button type=\"primary\" @click=\"operationData\">保存</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {\n  validatePhone,\n  validateUsername\n} from \"../../../utils/validate\";\nimport {getStudentInfo, removeStudentToClass, updateStudentInfo} from \"../../../api/students\";\nimport {selectClassList, selectTypeList} from \"../../../api/search\";\n\nexport default {\n  name: \"index\",\n  data() {\n    return {\n      params: {\n        studentId: '',\n        gradeId: ''\n      },\n      form: {},\n      rules: {\n        username: [{required: true, trigger: 'blur', validator: validatePhone}],\n        name: [{required: true, trigger: 'blur', validator: validateUsername}],\n      },\n      teacherList: [],\n      classList: [],\n      firstList: [],\n      recleaning1List: [],\n      recleaning2List: []\n    }\n  },\n  mounted() {\n    let {studentId, gradeId} = this.$route.query;\n    this.params.studentId = studentId;\n    this.params.gradeId = gradeId;\n    this.getEditData(this.params);\n    this.getClassData();\n    this.getFirstSelectData();\n    this.getRecleaningData();\n  },\n  methods: {\n    getFirstSelectData() {\n      selectTypeList('firstChoice')\n          .then(res => {\n            if (res.errorCode === 200) this.firstList = res.data;\n          })\n    },\n    getRecleaningData() {\n      selectTypeList('recleaning')\n          .then(res => {\n            console.log(res, 'sad');\n            if (res.errorCode === 200) {\n              this.recleaning1List = res.data;\n              this.recleaning2List = res.data;\n            }\n          })\n    },\n    getClassData() {\n      selectClassList()\n          .then(res => {\n            if (res.errorCode === 200) {\n              this.classList = res.data;\n            }\n          })\n    },\n    getEditData(params) {\n      getStudentInfo(params)\n          .then(res => {\n            if (res.errorCode === 200) {\n              this.form = res.data;\n              this.form['gender'] = this.form.gender == 'f' ? '男' : '女';\n\n            }\n          })\n    },\n    goBack() {\n      this.$router.go(-1);\n    },\n    removeClassInfo(studentId) {\n      let that = this;\n      that.$confirm('此操作将会将该名学生移出当前班级, 是否继续?', '移除学生', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        removeStudentToClass(studentId)\n            .then(res => {\n              if (res.errorCode === 200) {\n                that.$message({\n                  type: 'success',\n                  message: '移除成功!'\n                });\n                that.getEditData(that.params);\n              }\n            })\n      }).catch(() => {\n      });\n      console.log(studentId);\n    },\n    operationData() {\n      let that = this;\n      that.form['gender'] = this.form.gender === '男' ? 'f' : 'm';\n      that.$refs['form'].validate(valid => {\n        if (valid) {\n          updateStudentInfo(that.form)\n              .then(res => {\n                console.log(res);\n              })\n        } else {\n          return false;\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.student-table-title {\n  display: flex;\n  justify-content: space-around;\n  text-align: center;\n  align-items: center;\n  height: 54px;\n  background-color: #FFFFFF;\n\n  span {\n    width: 33.33%;\n    height: 54px;\n    line-height: 54px;\n    font-size: 14px;\n    font-family: PingFangSC-Medium, PingFang SC;\n    font-weight: 500;\n    color: #475B75;\n    border-top: 1px solid #dddee2;\n    border-right: 1px solid #dddee2;\n  }\n}\n\n.m-right {\n  margin-right: 20px;\n}\n</style>"]}]}